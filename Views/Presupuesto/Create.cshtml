@model Presupuesto

@{
    ViewBag.Title = "Nuevo Presupuesto";
}

<h2 class="mb-4">‚ûï Crear Nuevo Presupuesto</h2>

@using (Html.BeginForm()) 
{
    <div class="mb-3">
        @Html.LabelFor(m => m.NombreCliente)
        @Html.TextBoxFor(m => m.NombreCliente, new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.NombreCliente)
    </div>

    <div class="mb-3">
        @Html.LabelFor(m => m.TelefonoCliente)
        @Html.TextBoxFor(m => m.TelefonoCliente, new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.TelefonoCliente)
    </div>

    <div class="mb-3">
        @Html.LabelFor(m => m.Fecha)
        @Html.TextBoxFor(m => m.Fecha, "{0:yyyy-MM-dd}", new { @class = "form-control", type = "date" })
        @Html.ValidationMessageFor(m => m.Fecha)
    </div>

    <hr />

    <h4>üßæ √çtems del presupuesto</h4>
    <div id="itemsContainer"></div>

    <button type="button" class="btn btn-secondary my-2" onclick="agregarItem()">‚ûï Agregar √≠tem</button>

    <hr />

    <button type="submit" class="btn btn-primary">Guardar Presupuesto</button>
    <a href="@Url.Action("Index")" class="btn btn-outline-secondary">Cancelar</a>
}

@section scripts {
<script>
    let index = 0;

    function agregarItem() {
        const container = document.getElementById("itemsContainer");

        const html = `
            <div class="border rounded p-3 mb-3">
                <div class="row">
                    <div class="col-md-5">
                        <label>Descripci√≥n</label>
                        <input name="Items[${index}].Descripcion" class="form-control" />
                    </div>
                    <div class="col-md-2">
                        <label>Cantidad</label>
                        <input type="number" name="Items[${index}].Cantidad" class="form-control" min="1" />
                    </div>
                    <div class="col-md-3">
                        <label>Precio Unitario</label>
                        <input type="number" step="0.01" name="Items[${index}].PrecioUnitario" class="form-control" />
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="button" class="btn btn-danger w-100" onclick="this.parentElement.parentElement.parentElement.remove()">üóë Quitar</button>
                    </div>
                </div>
            </div>
        `;

        container.insertAdjacentHTML("beforeend", html);
        index++;
    }
</script>
}
